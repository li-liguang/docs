<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-cloud/k8s/nginx-ingress" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.5.2">
<title data-rh="true">nginx ingress controllerå®‰è£…æŒ‡å— | æ–‡æ¡£</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://li-liguang.github.io/docs/img/docusaurus-social-card.jpg"><meta data-rh="true" name="twitter:image" content="https://li-liguang.github.io/docs/img/docusaurus-social-card.jpg"><meta data-rh="true" property="og:url" content="https://li-liguang.github.io/docs/docs/cloud/k8s/nginx-ingress"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="nginx ingress controllerå®‰è£…æŒ‡å— | æ–‡æ¡£"><meta data-rh="true" name="description" content="æ”¯æŒå¤šç§å®‰è£…æ–¹å¼ï¼š"><meta data-rh="true" property="og:description" content="æ”¯æŒå¤šç§å®‰è£…æ–¹å¼ï¼š"><link data-rh="true" rel="icon" href="/docs/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://li-liguang.github.io/docs/docs/cloud/k8s/nginx-ingress"><link data-rh="true" rel="alternate" href="https://li-liguang.github.io/docs/docs/cloud/k8s/nginx-ingress" hreflang="en"><link data-rh="true" rel="alternate" href="https://li-liguang.github.io/docs/docs/cloud/k8s/nginx-ingress" hreflang="x-default"><link rel="alternate" type="application/rss+xml" href="/docs/blog/rss.xml" title="æ–‡æ¡£ RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/docs/blog/atom.xml" title="æ–‡æ¡£ Atom Feed"><link rel="stylesheet" href="/docs/assets/css/styles.1572a292.css">
<script src="/docs/assets/js/runtime~main.5d39a4a4.js" defer="defer"></script>
<script src="/docs/assets/js/main.84b247b2.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();t(null!==e?e:"light")}(),function(){try{const n=new URLSearchParams(window.location.search).entries();for(var[t,e]of n)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top navbarHideable_m1mJ"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" target="_self" href="/docs/"><div class="navbar__logo"><img src="/docs/img/logo.svg" alt="docs-website" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/docs/img/logo.svg" alt="docs-website" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">ä¸»é¡µ</b></a><a class="navbar__item navbar__link" href="/docs/docs/backend/springbootå¼€å‘æŠ€å·§/extra_properties">åç«¯</a><a class="navbar__item navbar__link" href="/docs/docs/front">å‰ç«¯</a><a class="navbar__item navbar__link" href="/docs/docs/server/jboss/jboss">æœåŠ¡å™¨</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs/docs/cloud/docker/docker">äº‘åŸç”Ÿ</a><a class="navbar__item navbar__link" href="/docs/docs/database/otherconfig">æ•°æ®åº“</a><a class="navbar__item navbar__link" href="/docs/docs/other/rpm/build-multi-architectural-rpm-packages">å…¶ä»–</a></div><div class="navbar__items navbar__items--right"><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link"><svg viewBox="0 0 24 24" width="20" height="20" aria-hidden="true" class="iconLanguage_nlXk"><path fill="currentColor" d="M12.87 15.07l-2.54-2.51.03-.03c1.74-1.94 2.98-4.17 3.71-6.53H17V4h-7V2H8v2H1v1.99h11.17C11.5 7.92 10.44 9.75 9 11.35 8.07 10.32 7.3 9.19 6.69 8h-2c.73 1.63 1.73 3.17 2.98 4.56l-5.09 5.02L4 19l5-5 3.11 3.11.76-2.04zM18.5 10h-2L12 22h2l1.12-3h4.75L21 22h2l-4.5-12zm-2.62 7l1.62-4.33L19.12 17h-3.24z"></path></svg>English</a><ul class="dropdown__menu"><li><a href="/docs/docs/cloud/k8s/nginx-ingress" target="_self" rel="noopener noreferrer" class="dropdown__link dropdown__link--active" lang="en">English</a></li></ul></div><a href="https://gitee.com/li-liguang" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link header-gitee-link" aria-label="Gitee repository"></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"><div class="navbar__search searchBarContainer_NW3z"><input placeholder="æœç´¢" aria-label="Search" class="navbar__search-input"><div class="loadingRing_RJI3 searchBarLoadingRing_YnHq"><div></div><div></div><div></div><div></div></div><div class="searchHintContainer_Pkmr"><kbd class="searchHint_iIMx">ctrl</kbd><kbd class="searchHint_iIMx">K</kbd></div></div></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd sidebarWithHideableNavbar_wUlq"><a tabindex="-1" class="sidebarLogo_isFc" target="_self" href="/docs/"><img src="/docs/img/logo.svg" alt="docs-website" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/docs/img/logo.svg" alt="docs-website" class="themedComponent_mlkZ themedComponent--dark_xIcU"><b>ä¸»é¡µ</b></a><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/docs/docs/cloud/docker/docker">docker</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" role="button" aria-expanded="true" href="/docs/docs/cloud/k8s/k8s">k8s</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/docs/cloud/k8s/k8s">Kubernetesè¯¦ç»†æ•™ç¨‹</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/docs/cloud/k8s/Kuberneteså¸¸ç”¨å‘½ä»¤">Kuberneteså¸¸ç”¨å‘½ä»¤</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/docs/cloud/k8s/baremetal">è£¸é‡‘å±å®‰è£…</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/docs/cloud/k8s/nfs-subdir-external-provisioner">åˆ›å»ºå¤–éƒ¨NFSå­˜å‚¨ç±»</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs/docs/cloud/k8s/nginx-ingress">nginx ingress controllerå®‰è£…æŒ‡å—</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/docs/cloud/k8s/å®‰è£…nginx-ingress-controller">å®‰è£…nginx-ingress-controller</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/docs/docs/cloud/helm/helm">helm</a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/docs/cloud/k8sä¸­éƒ¨ç½²gitea">k8sä¸­éƒ¨ç½²Gitea</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/docs/cloud/k8så®‰è£…Harbor">k8så®‰è£…Harbor</a></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/docs/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">k8s</span><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">nginx ingress controllerå®‰è£…æŒ‡å—</span><meta itemprop="position" content="2"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>nginx ingress controllerå®‰è£…æŒ‡å—</h1></header><p>æ”¯æŒå¤šç§å®‰è£…æ–¹å¼ï¼š</p>
<ul>
<li>ä½¿ç”¨Helmï¼Œä»chartä»“åº“å®‰è£…</li>
<li>ä½¿ç”¨<code>kubectl apply</code>ï¼ŒYAMLæ¸…å•å®‰è£…</li>
<li>ä»ç‰¹æ®ŠåŠ è½½é¡¹å®‰è£…ï¼ˆä¾‹å¦‚ï¼š<a href="#minikube">minikube</a>æˆ–è€…<a href="#microk8s">MicroK8s</a>ï¼‰</li>
</ul>
<p>å¯¹äºå¤§å¤šæ•°<code>Kubernetes</code>é›†ç¾¤ï¼Œingress controllerä¸éœ€è¦ä»»ä½•é¢å¤–çš„é…ç½®å³å¯å·¥ä½œã€‚å¦‚æœä½ æƒ³å°½å¿«å¼€å§‹ä½¿ç”¨ï¼Œæ‚¨å¯ä»¥æŸ¥çœ‹<a href="#%E5%BF%AB%E9%80%9F%E5%90%AF%E5%8A%A8">å¿«é€Ÿå¯åŠ¨</a>è¯´æ˜ã€‚ä½†æ˜¯ï¼Œåœ¨è®¸å¤šç¯å¢ƒä¸­ï¼Œæ‚¨å¯ä»¥é€šè¿‡å¯ç”¨é¢å¤–çš„ç‰¹æ€§æ¥æé«˜æ€§èƒ½æˆ–è·å¾—æ›´å¥½çš„æ—¥å¿—ã€‚æˆ‘ä»¬æ¨èæ‚¨æŸ¥çœ‹<a href="#%E7%89%B9%E5%AE%9A%E7%8E%AF%E5%A2%83%E8%AF%B4%E6%98%8E">ç‰¹å®šç¯å¢ƒè¯´æ˜</a>æœ‰å…³ä¸ºç‰¹å®šç¯å¢ƒæˆ–äº‘æä¾›å•†ä¼˜åŒ–å…¥å£æ§åˆ¶å™¨çš„è¯¦ç»†ä¿¡æ¯ã€‚</p>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="å†…å®¹">å†…å®¹<a href="#å†…å®¹" class="hash-link" aria-label="Direct link to å†…å®¹" title="Direct link to å†…å®¹">â€‹</a></h2>
<ul>
<li>å¿«é€Ÿå¯åŠ¨</li>
<li>ç‰¹å®šç¯å¢ƒè¯´æ˜<!-- -->
<ul>
<li>Docker desktop</li>
<li>minikube</li>
<li>MicroK8s</li>
<li>AWS</li>
<li>GCE - GKE</li>
<li>Azure</li>
<li>Digital Ocean</li>
<li>Scaleway</li>
<li>Exoscale</li>
<li>Oracle cloud infrastructure</li>
<li>Bare-metal(è£¸é‡‘å±)</li>
</ul>
</li>
<li>æ··åˆ</li>
</ul>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="å¿«é€Ÿå¯åŠ¨">å¿«é€Ÿå¯åŠ¨<a href="#å¿«é€Ÿå¯åŠ¨" class="hash-link" aria-label="Direct link to å¿«é€Ÿå¯åŠ¨" title="Direct link to å¿«é€Ÿå¯åŠ¨">â€‹</a></h2>
<p><strong>å¦‚æœæ‚¨æœ‰å®‰è£…Helm</strong>ï¼Œå¯ä»¥ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤å®‰è£…<code>ingress controller</code>:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">helm upgrade --install ingress-nginx ingress-nginx \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --repo https://kubernetes.github.io/ingress-nginx \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --namespace ingress-nginx --create-namespace</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>è¿™ä¸ªå‘½ä»¤ç›¸å½“äºï¼š
å¦‚æœå·²ç»å®‰è£…æ§åˆ¶å™¨ï¼Œå°±æ›´æ–°ï¼›å¦‚æœæ²¡æœ‰å®‰è£…åˆ™å®‰è£…ã€‚
<strong>å¦‚æœæ‚¨æ²¡æœ‰å®‰è£…Helm</strong>ï¼Œæˆ–è€…æ‚¨æ›´å–œæ¬¢ä½¿ç”¨YAMLæ¸…å•ï¼Œæ‚¨å¯ä»¥è¿è¡Œä»¥ä¸‹å‘½ä»¤å®‰è£…æ§åˆ¶å™¨ï¼š</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">kubectl apply -f https://raw.githubusercontent.com/kubernetes/ingress-nginx/controller-v1.2.0/deploy/static/provider/cloud/deploy.yaml</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<blockquote>
<p>ä¸Šé¢å‘½ä»¤ä½¿ç”¨çš„YAMLæ¸…å•æ˜¯ç”±Helmæ¨¡æ¿ç”Ÿæˆçš„ï¼Œå› æ­¤ä¸Šé¢ä¸¤ç§å®‰è£…æ–¹å¼å¾—åˆ°çš„k8sèµ„æºæ˜¯ç›¸åŒçš„ã€‚</p>
</blockquote>
<blockquote>
<p>æ³¨æ„ï¼šå¦‚æœæ‚¨çš„k8sç‰ˆæœ¬æ¯”è¾ƒè€ï¼ˆ1.18æˆ–æ›´æ—©ï¼‰ï¼Œè¯·é˜…è¯»<a href="https://github.com/kubernetes/ingress-nginx/blob/main/docs/deploy/index.md#running-on-Kubernetes-versions-older-than-1.19" target="_blank" rel="noopener noreferrer">è¿™æ®µ</a>ç‰¹æ®Šè¯´æ˜ã€‚</p>
</blockquote>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="ä½¿ç”¨å‰æ£€æŸ¥">ä½¿ç”¨å‰æ£€æŸ¥<a href="#ä½¿ç”¨å‰æ£€æŸ¥" class="hash-link" aria-label="Direct link to ä½¿ç”¨å‰æ£€æŸ¥" title="Direct link to ä½¿ç”¨å‰æ£€æŸ¥">â€‹</a></h3>
<p>åœ¨<code>nginx-ingress</code>è¿™ä¸ªå‘½åç©ºé—´ä¸‹ï¼Œåº”è¯¥æœ‰å‡ ä¸ªpodsè¿è¡Œã€‚</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">kubectl get pods --namespace=ingress-nginx</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>ç¨ç­‰ä¸€ä¼šï¼Œè¿™å‡ ä¸ªpodså°†å¤„äºè¿è¡Œä¸­çŠ¶æ€ã€‚ä¸‹é¢çš„å‘½ä»¤å°†ç­‰å¾…å…¥å£æ§åˆ¶å™¨PODå¯åŠ¨ ã€è¿è¡Œå¹¶å‡†å¤‡å°±ç»ªï¼š</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">kubectl wait --namespace ingress-nginx \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --for=condition=ready pod \  --selector=app.kubernetes.io/component=controller \  --timeout=120s</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="æœ¬åœ°æµ‹è¯•">æœ¬åœ°æµ‹è¯•<a href="#æœ¬åœ°æµ‹è¯•" class="hash-link" aria-label="Direct link to æœ¬åœ°æµ‹è¯•" title="Direct link to æœ¬åœ°æµ‹è¯•">â€‹</a></h3>
<p>åˆ›å»ºä¸€ä¸ªç®€å•çš„ç½‘ç»œæœåŠ¡ï¼Œä»¥åŠç›¸å…³è”çš„serviceï¼Œ</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">kubectl create deployment demo --image=httpd --port=80</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">kubectl expose deployment demo</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>ç„¶ååˆ›å»ºä¸€ä¸ªingressèµ„æº</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">kubectl create ingress demo-localhost --class=nginx \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --rule=demo.localdev.me/*=demo:80</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>ç„¶åï¼Œæ˜ å°„ä¸€ä¸ªæœ¬åœ°ç«¯å£</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">kubectl port-forward --namespace=ingress-nginx service/ingress-nginx-controller 8080:80</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>åˆ°è¿™é‡Œä¹‹åï¼Œå¦‚æœä½ åœ¨æµè§ˆå™¨è®¿é—®<a href="http://demo.localdev.me:8080/" target="_blank" rel="noopener noreferrer">http://demo.localdev.me:8080/</a>ï¼Œä½ å°†çœ‹åˆ°ä¸€ä¸ªå†™ç€â€œit works!â€çš„htmlé¡µé¢ã€‚</p>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="åœ¨çº¿æµ‹è¯•">åœ¨çº¿æµ‹è¯•<a href="#åœ¨çº¿æµ‹è¯•" class="hash-link" aria-label="Direct link to åœ¨çº¿æµ‹è¯•" title="Direct link to åœ¨çº¿æµ‹è¯•">â€‹</a></h3>
<p>å¦‚æœæ‚¨çš„Kubernetesé›†ç¾¤æ˜¯ä¸€ä¸ªâ€œçœŸæ­£çš„â€é›†ç¾¤ï¼Œå®ƒæ”¯æŒ<code>LoadBalenger</code>ç±»å‹çš„æœåŠ¡ï¼Œå®ƒå°†å‘å…¥å£æ§åˆ¶å™¨åˆ†é…å¤–éƒ¨IPåœ°å€æˆ–FQDNã€‚
æ‚¨å¯ä»¥é€šè¿‡ä»¥ä¸‹å‘½ä»¤çœ‹åˆ°IPåœ°å€æˆ–FQDNï¼š</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">kubectl get service ingress-nginx-controller --namespace=ingress-nginx</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>å®ƒå°†æ˜¯<code>EXTERNAL</code>å­—æ®µã€‚å¦‚æœè¯¥å­—æ®µæ˜¾ç¤º<code>&lt;Pending&gt;</code>ï¼Œè¿™æ„å‘³ç€æ‚¨çš„Kubernetesé›†ç¾¤æ— æ³•æä¾›è´Ÿè½½å‡è¡¡å™¨(é€šå¸¸ï¼Œè¿™æ˜¯å› ä¸ºå®ƒä¸æ”¯æŒ<code>LoadBalenger</code>ç±»å‹çš„æœåŠ¡)ã€‚
å¦‚æœæœ‰å¤–éƒ¨IPåœ°å€(æˆ–è€…FQDN)ï¼Œè®¾ç½®ä¸€ä¸ªæŒ‡å‘å®ƒçš„DNSè®°å½•ã€‚ç„¶ååˆ›å»ºä¸€ä¸ªingressèµ„æºã€‚ä¸‹é¢è¿™ä¸ªç¤ºä¾‹ï¼Œå‡å®šè®¾ç½®äº†ä¸€ä¸ª<code>www.demo.io</code>çš„DNSï¼š</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">kubectl create ingress demo --class=nginx \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --rule=&quot;www.demo.io/*=demo:80&quot;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>æˆ–è€…ï¼Œä¸Šé¢çš„å‘½ä»¤å¯ä»¥ä½¿ç”¨<code>--rule</code>å‘½ä»¤æ›¿ä»£ï¼š</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">kubectl create ingress demo --class=nginx \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --rule www.demo.io/=demo:80</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>å½“æµè§ˆå™¨è®¿é—®<a href="http://www.demo.io/" target="_blank" rel="noopener noreferrer">http://www.demo.io/</a>æ—¶ï¼Œä½ å¯ä»¥çœ‹åˆ°ä¸€ä¸ªå†™ç€â€œit works!â€çš„htmlé¡µé¢ã€‚æ­å–œæ‚¨ï¼Œæ‚¨æ­£åœ¨ä¸ºä¸€ä¸ªåœ¨Kubernetesé›†ç¾¤ä¸Šæ‰˜ç®¡çš„å…¬å…±ç½‘ç«™æœåŠ¡ï¼ ğŸ‰</p>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="ç‰¹å®šç¯å¢ƒè¯´æ˜">ç‰¹å®šç¯å¢ƒè¯´æ˜<a href="#ç‰¹å®šç¯å¢ƒè¯´æ˜" class="hash-link" aria-label="Direct link to ç‰¹å®šç¯å¢ƒè¯´æ˜" title="Direct link to ç‰¹å®šç¯å¢ƒè¯´æ˜">â€‹</a></h2>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="æœ¬åœ°å¼€å‘ç¯å¢ƒé›†ç¾¤">æœ¬åœ°å¼€å‘ç¯å¢ƒé›†ç¾¤<a href="#æœ¬åœ°å¼€å‘ç¯å¢ƒé›†ç¾¤" class="hash-link" aria-label="Direct link to æœ¬åœ°å¼€å‘ç¯å¢ƒé›†ç¾¤" title="Direct link to æœ¬åœ°å¼€å‘ç¯å¢ƒé›†ç¾¤">â€‹</a></h3>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="minikube">minikube<a href="#minikube" class="hash-link" aria-label="Direct link to minikube" title="Direct link to minikube">â€‹</a></h4>
<p>å…¥å£æ§åˆ¶å™¨å¯ä»¥é€šè¿‡Minkubeçš„åŠ è½½é¡¹ç³»ç»Ÿå®‰è£…ï¼š</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">minikube addons enable ingress</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="microk8s">MicroK8s<a href="#microk8s" class="hash-link" aria-label="Direct link to MicroK8s" title="Direct link to MicroK8s">â€‹</a></h4>
<p>å…¥å£æ§åˆ¶å™¨å¯ä»¥é€šè¿‡MicroK8sçš„åŠ è½½é¡¹ç³»ç»Ÿå®‰è£…ï¼š</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">microk8s enable ingress</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>è¯¦æƒ…è¯·æŸ¥çœ‹<a href="https://microk8s.io/docs/addon-ingress" target="_blank" rel="noopener noreferrer">MicroK8sæ–‡æ¡£</a></p>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="docker-desktop">Docker Desktop<a href="#docker-desktop" class="hash-link" aria-label="Direct link to Docker Desktop" title="Direct link to Docker Desktop">â€‹</a></h4>
<p>ä»¥ä¸‹Docker Desktopç‰ˆæœ¬æ”¯æŒKubernetesï¼š</p>
<ul>
<li>Macï¼š<a href="https://docs.docker.com/docker-for-mac/release-notes/#stable-releases-of-2018" target="_blank" rel="noopener noreferrer">version 18.06.0-ce</a></li>
<li>Windowsï¼š<a href="https://docs.docker.com/docker-for-windows/release-notes/#docker-community-edition-18060-ce-win70-2018-07-25" target="_blank" rel="noopener noreferrer">version 18.06.0-ce</a></li>
</ul>
<p>é¦–å…ˆï¼Œç¡®è®¤Dockerè®¾ç½®ä¸­æ˜¯å¦å¯ç”¨Kubernetesã€‚å‘½ä»¤<code>kubectl get nodes</code>éœ€æ˜¾ç¤ºä¸€ä¸ªåä¸º<code>docker-desktop</code>çš„å•èŠ‚ç‚¹ã€‚
åœ¨docker desktopå¯ä»¥ä½¿ç”¨é»˜è®¤å¿«é€Ÿå¯åŠ¨è¯´æ˜ï¼Œå®‰è£…ingressæ§åˆ¶å™¨ã€‚
åœ¨å¤§éƒ¨åˆ†ç³»ç»Ÿä¸­ï¼Œå¦‚æœæ²¡æœ‰å…¶ä»–<code>LoadBalancer</code>ç±»å‹çš„serviceç»‘å®šåˆ°80ç«¯å£ï¼Œingressæ§åˆ¶å™¨å°†è¢«æŒ‡æ´¾ä¸€ä¸ª<code>localhost</code>çš„å¤–éƒ¨IP(<code>EXTERNAL_IP</code>)ï¼Œè¿™æ„å‘³ç€å®ƒå¯ä»¥åœ¨æœ¬åœ°é€šè¿‡<code>localhost:80</code>è®¿é—®ã€‚å¦‚æœä¸èµ·ä½œç”¨ï¼Œä½ å¯èƒ½éœ€è¦å›åˆ°<a href="#%E6%9C%AC%E5%9C%B0%E6%B5%8B%E8%AF%95">æœ¬åœ°æµ‹è¯•</a>ç« èŠ‚çš„<code>kubectl port-forward</code>æ–¹æ³•æè¿°ã€‚</p>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="äº‘éƒ¨ç½²ç¯å¢ƒ">äº‘éƒ¨ç½²ç¯å¢ƒ<a href="#äº‘éƒ¨ç½²ç¯å¢ƒ" class="hash-link" aria-label="Direct link to äº‘éƒ¨ç½²ç¯å¢ƒ" title="Direct link to äº‘éƒ¨ç½²ç¯å¢ƒ">â€‹</a></h3>
<p>åœ¨æŸäº›æƒ…å†µä¸‹ï¼Œå¦‚æœäº‘æä¾›å•†çš„è´Ÿè½½å¹³è¡¡å™¨å¯¹å…¶åç«¯æ‰§è¡Œä¸»åŠ¨å¥åº·æ£€æŸ¥(å¤§å¤šæ•°æ˜¯è¿™æ ·)ï¼Œä½ å¯ä»¥æ›´æ”¹ingressæ§åˆ¶å™¨serviceçš„<code>externalTrafficPolicy</code>ä¸º<code>Local</code>(é»˜è®¤å€¼ä¸º<code>Cluster</code>)æ¥ä¿å­˜ä¸€ä¸ªé¢å¤–çš„hopã€‚å¦‚æœæ‚¨ä½¿ç”¨Helmå®‰è£…ï¼Œå¯ä»¥åœ¨<code>helm install</code>æˆ–è€…<code>helm upgrade</code>æ—¶æ·»åŠ å‘½ä»¤<code>--set controller.service.externalTrafficPolicy=Local</code>æ¥å®Œæˆä¸Šè¿°æ“ä½œã€‚</p>
<p>æ­¤å¤–ï¼Œå¦‚æœäº‘æœåŠ¡æä¾›å•†çš„è´Ÿè½½å‡è¡¡å™¨ï¼Œæ”¯æŒä»£ç†åè®®ï¼Œä½ å¯ä»¥å¯ç”¨å®ƒï¼Œå®ƒå¯ä»¥è®©ingressæ§åˆ¶å™¨çœ‹åˆ°å®¢æˆ·ç«¯çš„çœŸå®IPåœ°å€ã€‚å¦åˆ™ï¼Œé€šå¸¸ä¼šçœ‹åˆ°ä¸Šè¡Œè´Ÿè½½å‡è¡¡å™¨çš„IPåœ°å€ã€‚è¦å®ç°è¿™ä¸ªæ•ˆæœï¼Œå¿…é¡»åŒæ—¶åœ¨äº‘æä¾›å•†çš„è´Ÿè½½å‡è¡¡å™¨é…ç½®ï¼Œä»¥åŠingressæ§åˆ¶å™¨è®¾ç½®<code>--set controller.config.use-proxy-protocol=true</code>æ‰èƒ½ç”Ÿæ•ˆã€‚</p>
<p>åœ¨ä¸‹é¢çš„éƒ¨åˆ†ä¸­ï¼Œæˆ‘ä»¬æä¾›äº†YAMLæ¸…å•ï¼Œåœ¨å¯èƒ½çš„æƒ…å†µä¸‹ä½¿ç”¨å„ç§äº‘æä¾›å•†çš„ç‰¹å®šé€‰é¡¹å¯ç”¨è¿™äº›é€‰é¡¹ã€‚</p>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="aws">AWS<a href="#aws" class="hash-link" aria-label="Direct link to AWS" title="Direct link to AWS">â€‹</a></h4>
<p>åœ¨AWSä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨ä¸€ä¸ªç½‘ç»œè´Ÿè½½å‡è¡¡å™¨<code>Network Load Balancer(NLB)</code>æš´éœ²Serviceçš„typeç±»å‹ä¸º<code>LoadBalancer</code>çš„<code>nginx ingress controller</code>ã€‚</p>
<blockquote>
<p>info</p>
</blockquote>
<h5 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="network-load-balancernlb">Network Load Balancer(NLB)<a href="#network-load-balancernlb" class="hash-link" aria-label="Direct link to Network Load Balancer(NLB)" title="Direct link to Network Load Balancer(NLB)">â€‹</a></h5>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">kubectl apply -f https://raw.githubusercontent.com/kubernetes/ingress-nginx/controller-v1.2.0/deploy/static/provider/aws/deploy.yaml</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h5 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="tls-termination-in-aws-load-balancernlb">TLS termination in AWS Load Balancer(NLB)<a href="#tls-termination-in-aws-load-balancernlb" class="hash-link" aria-label="Direct link to TLS termination in AWS Load Balancer(NLB)" title="Direct link to TLS termination in AWS Load Balancer(NLB)">â€‹</a></h5>
<p>é»˜è®¤æƒ…å†µä¸‹ï¼ŒTLSåœ¨å…¥å£æ§åˆ¶å™¨ä¸­ç»ˆæ­¢ã€‚ä½†åœ¨è´Ÿè½½å‡è¡¡å™¨ä¸­ä¹Ÿæœ‰å¯èƒ½ç»ˆæ­¢TLSã€‚æœ¬èŠ‚è§£é‡Šå¦‚ä½•ä½¿ç”¨NLBåœ¨AWSä¸Šæ‰§è¡Œæ­¤æ“ä½œã€‚</p>
<ol>
<li>ä¸‹è½½deploy.yamlæ¨¡æ¿</li>
</ol>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">wget https://raw.githubusercontent.com/kubernetes/ingress-nginx/controller-v1.2.0/deploy/static/provider/aws/nlb-with-tls-termination/deploy.yaml</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<ol start="2">
<li>ä¿®æ”¹æ–‡ä»¶ï¼Œå°†PVC CIDRæ”¹ä¸ºå¯¹åº”çš„k8sé›†ç¾¤é…ç½®</li>
</ol>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">proxy-real-ip-cidr: XXX.XXX.XXX/XX</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<ol start="3">
<li>è¿˜æ›´æ”¹AWSè¯ä¹¦ç®¡ç†å™¨(ACM)IDï¼š</li>
</ol>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">arn:aws:acm:us-west-2:XXXXXXXX:certificate/XXXXXX-XXXXXXX-XXXXXXX-XXXXXXXX</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<ol start="4">
<li>éƒ¨ç½²yamlæ¸…å•</li>
</ol>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">kubectl apply -f deploy.yaml</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h5 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="nlb-idle-timeouts">NLB Idle Timeouts<a href="#nlb-idle-timeouts" class="hash-link" aria-label="Direct link to NLB Idle Timeouts" title="Direct link to NLB Idle Timeouts">â€‹</a></h5>
<p>TCPè¯·æ±‚çš„ç©ºé—²è¶…æ—¶æ—¶é—´ä¸º350ç§’ï¼Œå¹¶ä¸”æ— æ³•ä¿®æ”¹ã€‚
ç”±äºè¿™ä¸ªåŸå› ï¼Œæ‚¨éœ€è¦ç¡®ä¿<code>keepalive_timeout</code>å€¼çš„é…ç½®å°äº350ç§’æ‰èƒ½æŒ‰é¢„æœŸå·¥ä½œã€‚
nginxçš„é»˜è®¤<code>keepalive_timeout</code>å€¼ä¸º<code>75s</code>ã€‚
å…³äºè¶…æ—¶çš„æ›´å¤šè¯¦ç»†ä¿¡æ¯ï¼Œè¯·æŸ¥çœ‹<a href="https://docs.aws.amazon.com/elasticloadbalancing/latest/network/network-load-balancers.html#connection-idle-timeout" target="_blank" rel="noopener noreferrer">AWSå®˜æ–¹æ–‡æ¡£</a></p>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="gce-gke">GCE-GKE<a href="#gce-gke" class="hash-link" aria-label="Direct link to GCE-GKE" title="Direct link to GCE-GKE">â€‹</a></h4>
<p>é¦–å…ˆï¼Œä½ çš„ç”¨æˆ·éœ€è¦åœ¨k8sé›†ç¾¤ä¸­æ‹¥æœ‰<code>cluster-admin</code>æƒé™ã€‚å¯ä»¥ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤è·å–æƒé™ï¼š</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">kubectl create clusterrolebinding cluster-admin-binding \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --clusterrole cluster-admin \  --user $(gcloud config get-value account)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>ç„¶åï¼Œä½ å¯ä»¥å¦‚ä¸‹æ–¹å¼ï¼Œå®‰è£…ingressæ§åˆ¶å™¨ï¼š</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">kubectl apply -f https://raw.githubusercontent.com/kubernetes/ingress-nginx/controller-v1.2.0/deploy/static/provider/cloud/deploy.yaml</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<blockquote>
<p>warnning å¯¹äºç§æœ‰é›†ç¾¤ï¼Œæ‚¨è¿˜éœ€è¦æ·»åŠ ä¸€æ¡é¢å¤–çš„é˜²ç«å¢™è§„åˆ™ï¼Œæ¥å…è®¸é›†ç¾¤masterèŠ‚ç‚¹åœ¨å·¥ä½œèŠ‚ç‚¹ä¸Šé…ç½®ä½¿ç”¨<code>8443/tcp</code>ç«¯å£ï¼Œæˆ–è€…ä¿®æ”¹å…è®¸è®¿é—®ç«¯å£<code>80/tcp</code>ã€<code>443/tcp</code>å’Œ<code>10254/tcp</code>çš„ç°æœ‰è§„åˆ™ï¼Œä¹Ÿå…è®¸è®¿é—®ç«¯å£<code>8443/tcp</code>ã€‚</p>
</blockquote>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">See the [GKE documentation](https://cloud.google.com/kubernetes-engine/docs/how-to/private-clusters#add_firewall_rules) on adding rules and the [Kubernetes issue](https://github.com/kubernetes/kubernetes/issues/79739) for more detail.</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<blockquote>
<p>æ³¨æ„ï¼Œ<code>KCE-GKE</code>ä¸æ”¯æŒä»£ç†åè®®ï¼</p>
</blockquote>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="azure">Azure<a href="#azure" class="hash-link" aria-label="Direct link to Azure" title="Direct link to Azure">â€‹</a></h4>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">kubectl apply -f https://raw.githubusercontent.com/kubernetes/ingress-nginx/controller-v1.2.0/deploy/static/provider/cloud/deploy.yaml</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>å…³äºAzureæ³¨è§£çš„æ›´å¤šä¿¡æ¯ï¼Œè¯·æŸ¥çœ‹<a href="https://docs.microsoft.com/en-us/azure/aks/ingress-internal-ip#create-an-ingress-controller" target="_blank" rel="noopener noreferrer">AKSå®˜æ–¹æ–‡æ¡£</a></p>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="digital-ocean">Digital Ocean<a href="#digital-ocean" class="hash-link" aria-label="Direct link to Digital Ocean" title="Direct link to Digital Ocean">â€‹</a></h4>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">kubectl apply -f https://raw.githubusercontent.com/kubernetes/ingress-nginx/controller-v1.2.0/deploy/static/provider/do/deploy.yaml</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="scaleway">Scaleway<a href="#scaleway" class="hash-link" aria-label="Direct link to Scaleway" title="Direct link to Scaleway">â€‹</a></h4>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">kubectl apply -f https://raw.githubusercontent.com/kubernetes/ingress-nginx/controller-v1.2.0/deploy/static/provider/scw/deploy.yaml</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="exoscale">Exoscale<a href="#exoscale" class="hash-link" aria-label="Direct link to Exoscale" title="Direct link to Exoscale">â€‹</a></h4>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">kubectl apply -f https://raw.githubusercontent.com/kubernetes/ingress-nginx/main/deploy/static/provider/exoscale/deploy.yaml</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Exoscaleæ”¯æŒçš„æ³¨é‡Šçš„å®Œæ•´åˆ—è¡¨å¯åœ¨ExoscaleCloudController Manager<a href="https://github.com/exoscale/exoscale-cloud-controller-manager/blob/master/docs/service-loadbalancer.md" target="_blank" rel="noopener noreferrer">æ–‡æ¡£</a>ä¸­è·å¾—ã€‚</p>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="oracle-cloud-infrastructure">Oracle Cloud Infrastructure<a href="#oracle-cloud-infrastructure" class="hash-link" aria-label="Direct link to Oracle Cloud Infrastructure" title="Direct link to Oracle Cloud Infrastructure">â€‹</a></h4>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">kubectl apply -f https://raw.githubusercontent.com/kubernetes/ingress-nginx/controller-v1.2.0/deploy/static/provider/cloud/deploy.yaml</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Oracleäº‘åŸºç¡€è®¾æ–½å¯ç”¨æ³¨é‡Šçš„<a href="https://github.com/oracle/oci-cloud-controller-manager/blob/master/docs/load-balancer-annotations.md" target="_blank" rel="noopener noreferrer">å®Œæ•´åˆ—è¡¨</a>å¯ä»¥åœ¨OCI Cloud Controller Manager<a href="https://github.com/oracle/oci-cloud-controller-manager" target="_blank" rel="noopener noreferrer">æ–‡æ¡£</a>ä¸­æ‰¾åˆ°ã€‚</p>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="bare-metal-clusters">Bare Metal Clusters<a href="#bare-metal-clusters" class="hash-link" aria-label="Direct link to Bare Metal Clusters" title="Direct link to Bare Metal Clusters">â€‹</a></h3>
<p>æœ¬èŠ‚é€‚ç”¨äºéƒ¨ç½²åœ¨è£¸æœºæœåŠ¡å™¨ä¸Šçš„Kubernetesç¾¤é›†ï¼Œä»¥åŠæ‰‹åŠ¨åœ¨â€œrawâ€è™šæ‹Ÿæœºä¸Šå®‰è£…çš„K8sé›†ç¾¤ï¼Œä½¿ç”¨é€šç”¨Linuxå‘è¡Œç‰ˆï¼ˆä¾‹å¦‚CentOS, Ubuntu...ï¼‰</p>
<p>ä¸ºäº†å¿«é€Ÿæµ‹è¯•ï¼Œæ‚¨å¯ä»¥ä½¿ç”¨<code>NodePort</code>ã€‚è¿™åº”è¯¥é€‚ç”¨äºå‡ ä¹æ‰€æœ‰é›†ç¾¤ï¼Œä½†å®ƒé€šå¸¸ä¼šä½¿ç”¨èŒƒå›´ä¸º<code>30000-32767</code>çš„ç«¯å£ã€‚</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">kubectl apply -f https://raw.githubusercontent.com/kubernetes/ingress-nginx/controller-v1.2.0/deploy/static/provider/baremetal/deploy.yaml</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>å…³äºåœ¨è£¸é‡‘å±éƒ¨ç½²çš„æ›´å¤šä¿¡æ¯ï¼Œè¯·æŸ¥çœ‹<a href="https://github.com/kubernetes/ingress-nginx/blob/main/docs/deploy/baremetal.md" target="_blank" rel="noopener noreferrer">è£¸é‡‘å±æ³¨æ„äº‹é¡¹</a>ã€‚</p>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="miscellaneous">Miscellaneous<a href="#miscellaneous" class="hash-link" aria-label="Direct link to Miscellaneous" title="Direct link to Miscellaneous">â€‹</a></h2>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="checking-ingress-controller-version">Checking ingress controller version<a href="#checking-ingress-controller-version" class="hash-link" aria-label="Direct link to Checking ingress controller version" title="Direct link to Checking ingress controller version">â€‹</a></h3>
<p>ä½¿ç”¨<code>kubectl exec</code>åœ¨podå®¹å™¨ä¸­æ‰§è¡Œå‘½ä»¤<code>/nginx-ingress-controller --version</code></p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">POD_NAMESPACE=ingress-nginx</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">POD_NAME=$(kubectl get pods -n $POD_NAMESPACE -l app.kubernetes.io/name=ingress-nginx --field-selector=status.phase=Running -o name)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">kubectl exec $POD_NAME -n $POD_NAMESPACE -- /nginx-ingress-controller --version</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="scope">Scope<a href="#scope" class="hash-link" aria-label="Direct link to Scope" title="Direct link to Scope">â€‹</a></h3>
<p>é»˜è®¤æƒ…å†µä¸‹ï¼Œæ§åˆ¶å™¨åœ¨æ‰€æœ‰å‘½åç©ºé—´ç›‘æ§<code>Ingress</code>å¯¹è±¡ã€‚å¦‚æœä½ æƒ³æ”¹å˜è¿™ä¸€è¡Œä¸ºï¼Œå¯ä»¥ä½¿ç”¨<code>--watch-namespace</code>æˆ–è€…æ£€æŸ¥Helm chartä¸­çš„<code>controller.scope</code>å€¼ï¼Œæ¥é™å®šæ§åˆ¶å™¨ç›‘å¬æŸä¸€ä¸ªå•ç‹¬çš„å‘½åç©ºé—´ã€‚</p>
<p>æ›´å¤šè¯¦æƒ…è¯·æŸ¥çœ‹<a href="https://kubernetes.github.io/ingress-nginx/#how-to-easily-install-multiple-instances-of-the-ingress-nginx-controller-in-the-same-cluster" target="_blank" rel="noopener noreferrer">åœ¨åŒä¸€ä¸ªé›†ç¾¤å¦‚ä½•è½»æ¾å®‰è£…å¤šä¸ª<code>ingress-nginx-controller</code>å®ä¾‹</a>ã€‚</p>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="webhook-network-access">Webhook network access<a href="#webhook-network-access" class="hash-link" aria-label="Direct link to Webhook network access" title="Direct link to Webhook network access">â€‹</a></h3>
<blockquote>
<p>è­¦å‘Šï¼šæ§åˆ¶å™¨ä½¿ç”¨<a href="https://kubernetes.io/docs/reference/access-authn-authz/extensible-admission-controllers/" target="_blank" rel="noopener noreferrer">admission webhook</a>æ¥æ ¡éªŒIngresså®šä¹‰ã€‚ç¡®ä¿æ²¡æœ‰ç½‘ç»œç­–ç•¥æˆ–å…¶ä»–é˜²ç«å¢™é˜»æ­¢ä»APIæœåŠ¡å™¨åˆ°<code>ingress-nginx-controller-admission</code>æœåŠ¡çš„è¿æ¥ã€‚</p>
</blockquote>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="certificate-generation">Certificate generation<a href="#certificate-generation" class="hash-link" aria-label="Direct link to Certificate generation" title="Direct link to Certificate generation">â€‹</a></h3>
<p>ç”Ÿæˆè¯ä¹¦ã€‚</p>
<blockquote>
<p>æ³¨æ„ï¼šingressæ§åˆ¶å™¨å¯åŠ¨çš„ç¬¬ä¸€æ—¶é—´ï¼Œä¸¤ä¸ª<code>Job</code>ä½¿ç”¨<code>admission webhook</code>åˆ›å»º<code>SSL</code>è¯ä¹¦ã€‚</p>
</blockquote>
<p>åœ¨åˆ›å»ºå’ŒéªŒè¯Ingresså®šä¹‰ä¹‹å‰ï¼Œè¿™å¯èƒ½ä¼šå¯¼è‡´é•¿è¾¾ä¸¤åˆ†é’Ÿçš„åˆå§‹å»¶è¿Ÿã€‚</p>
<p>æ‚¨å¯ä»¥è¿è¡Œä»¥ä¸‹å‘½ä»¤ï¼Œç­‰åˆ°å®ƒå‡†å¤‡å¥½ï¼š</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"> kubectl wait --namespace ingress-nginx \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --for=condition=ready pod \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --selector=app.kubernetes.io/component=controller \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --timeout=120s</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="running-on-k8s-version-older-than-119">Running on k8s version older than 1.19<a href="#running-on-k8s-version-older-than-119" class="hash-link" aria-label="Direct link to Running on k8s version older than 1.19" title="Direct link to Running on k8s version older than 1.19">â€‹</a></h3>
<p>Ingressèµ„æºéšç€æ—¶é—´çš„æ¨ç§»åœ¨ä¸æ–­è¿›åŒ–ã€‚ä»å¼€å§‹çš„<code>apiVersion: extensions/v1beta1</code>ï¼Œåˆ°<code>apiVersion: networking.k8s.io/v1beta1</code>ï¼Œå†åˆ°ä¸ä¹…å‰çš„<code>apiVersion: networking.k8s.io/v1</code>ã€‚</p>
<p>Kubernetesæ”¯æŒçš„Ingressç‰ˆæœ¬ä¿¡æ¯å¦‚ä¸‹ï¼š</p>
<ul>
<li>1.19ç‰ˆæœ¬ä¹‹å‰ï¼Œåªæ”¯æŒ``v1beta1`ç‰ˆæœ¬</li>
<li>1.19åˆ°1.21ç‰ˆæœ¬ï¼Œæ”¯æŒ<code>v1beta1</code>å’Œ<code>v1</code>ç‰ˆæœ¬</li>
<li>1.22ç‰ˆæœ¬ä¹‹åï¼Œåªæ”¯æŒ<code>v1</code>ç‰ˆæœ¬</li>
</ul>
<p>åœ¨<code>nginx ingress controller</code>ä¸­å¯¹ingressç‰ˆæœ¬çš„æ”¯æŒï¼š</p>
<ul>
<li>1.0ç‰ˆæœ¬ä¹‹å‰ï¼Œåªæ”¯æŒ<code>v1beta1</code>çš„ingressèµ„æº</li>
<li>1.0ç‰ˆæœ¬ä¹‹åï¼Œåªæ”¯æŒ<code>v1</code>çš„ingressèµ„æº</li>
</ul>
<p>å› æ­¤ï¼Œå¦‚æœä½ çš„k8sç‰ˆæœ¬ä¸º1.19æˆ–æ›´æ–°ç‰ˆæœ¬ï¼Œä½ åº”è¯¥èƒ½å¤Ÿä½¿ç”¨æœ€æ–°ç‰ˆæœ¬çš„<code>nginx-ingress-controller</code>ï¼›ä½†æ˜¯å¦‚æœä½ ä½¿ç”¨1.19ç‰ˆæœ¬ä¹‹å‰çš„k8sï¼Œå¿…é¡»ä½¿ç”¨<code>0.X</code>ç‰ˆæœ¬çš„<code>nginx-ingress-controller</code>ï¼ˆä¾‹å¦‚ï¼š0.49ç‰ˆæœ¬ï¼‰ã€‚</p>
<p><code>nginx-ingress-controller</code>çš„Heml chartåœ¨ç‰ˆæœ¬4ä¸­åˆ‡æ¢åˆ°ç‰ˆæœ¬1ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œå¦‚æœä½ çš„k8sé›†ç¾¤ç‰ˆæœ¬ä¸º1.19æˆ–æ›´æ—©ï¼Œä½ å¯ä»¥ä½¿ç”¨<code>3.X</code>ç‰ˆæœ¬çš„chartï¼ˆå¯ä»¥åœ¨<code>heml install</code>ä¸­ä½¿ç”¨<code>--version=&#x27;&lt;4&#x27;</code>å‘½ä»¤ï¼‰ã€‚</p></div></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/docs/docs/cloud/k8s/nfs-subdir-external-provisioner"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">åˆ›å»ºå¤–éƒ¨NFSå­˜å‚¨ç±»</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/docs/docs/cloud/k8s/å®‰è£…nginx-ingress-controller"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">å®‰è£…nginx-ingress-controller</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#å†…å®¹" class="table-of-contents__link toc-highlight">å†…å®¹</a></li><li><a href="#å¿«é€Ÿå¯åŠ¨" class="table-of-contents__link toc-highlight">å¿«é€Ÿå¯åŠ¨</a><ul><li><a href="#ä½¿ç”¨å‰æ£€æŸ¥" class="table-of-contents__link toc-highlight">ä½¿ç”¨å‰æ£€æŸ¥</a></li><li><a href="#æœ¬åœ°æµ‹è¯•" class="table-of-contents__link toc-highlight">æœ¬åœ°æµ‹è¯•</a></li><li><a href="#åœ¨çº¿æµ‹è¯•" class="table-of-contents__link toc-highlight">åœ¨çº¿æµ‹è¯•</a></li></ul></li><li><a href="#ç‰¹å®šç¯å¢ƒè¯´æ˜" class="table-of-contents__link toc-highlight">ç‰¹å®šç¯å¢ƒè¯´æ˜</a><ul><li><a href="#æœ¬åœ°å¼€å‘ç¯å¢ƒé›†ç¾¤" class="table-of-contents__link toc-highlight">æœ¬åœ°å¼€å‘ç¯å¢ƒé›†ç¾¤</a></li><li><a href="#äº‘éƒ¨ç½²ç¯å¢ƒ" class="table-of-contents__link toc-highlight">äº‘éƒ¨ç½²ç¯å¢ƒ</a></li><li><a href="#bare-metal-clusters" class="table-of-contents__link toc-highlight">Bare Metal Clusters</a></li></ul></li><li><a href="#miscellaneous" class="table-of-contents__link toc-highlight">Miscellaneous</a><ul><li><a href="#checking-ingress-controller-version" class="table-of-contents__link toc-highlight">Checking ingress controller version</a></li><li><a href="#scope" class="table-of-contents__link toc-highlight">Scope</a></li><li><a href="#webhook-network-access" class="table-of-contents__link toc-highlight">Webhook network access</a></li><li><a href="#certificate-generation" class="table-of-contents__link toc-highlight">Certificate generation</a></li><li><a href="#running-on-k8s-version-older-than-119" class="table-of-contents__link toc-highlight">Running on k8s version older than 1.19</a></li></ul></li></ul></div></div></div></div></main></div></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Docs</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/docs/docs/intro">Tutorial</a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/docs/blog">Blog</a></li><li class="footer__item"><a href="https://github.com/li-liguang" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright Â© 2024 My Project, Inc. Built with Docusaurus.</div></div></div></footer></div>
</body>
</html>