"use strict";(self.webpackChunkdocs_website=self.webpackChunkdocs_website||[]).push([[8711],{6414:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>d,contentTitle:()=>i,default:()=>h,frontMatter:()=>c,metadata:()=>o,toc:()=>a});var r=s(4848),l=s(8453);const c={id:"nginx-ingress",title:"nginx ingress controller\u5b89\u88c5\u6307\u5357",sidebar_label:"nginx ingress controller\u5b89\u88c5\u6307\u5357"},i=void 0,o={id:"cloud/k8s/nginx-ingress",title:"nginx ingress controller\u5b89\u88c5\u6307\u5357",description:"\u652f\u6301\u591a\u79cd\u5b89\u88c5\u65b9\u5f0f\uff1a",source:"@site/docs/cloud/2-k8s/nginx-ingress-controller.md",sourceDirName:"cloud/2-k8s",slug:"/cloud/k8s/nginx-ingress",permalink:"/docs/docs/cloud/k8s/nginx-ingress",draft:!1,unlisted:!1,tags:[],version:"current",frontMatter:{id:"nginx-ingress",title:"nginx ingress controller\u5b89\u88c5\u6307\u5357",sidebar_label:"nginx ingress controller\u5b89\u88c5\u6307\u5357"},sidebar:"cloudSidebar",previous:{title:"\u521b\u5efa\u5916\u90e8NFS\u5b58\u50a8\u7c7b",permalink:"/docs/docs/cloud/k8s/nfs-subdir-external-provisioner"},next:{title:"\u5b89\u88c5nginx-ingress-controller",permalink:"/docs/docs/cloud/k8s/\u5b89\u88c5nginx-ingress-controller"}},d={},a=[{value:"\u5185\u5bb9",id:"\u5185\u5bb9",level:2},{value:"\u5feb\u901f\u542f\u52a8",id:"\u5feb\u901f\u542f\u52a8",level:2},{value:"\u4f7f\u7528\u524d\u68c0\u67e5",id:"\u4f7f\u7528\u524d\u68c0\u67e5",level:3},{value:"\u672c\u5730\u6d4b\u8bd5",id:"\u672c\u5730\u6d4b\u8bd5",level:3},{value:"\u5728\u7ebf\u6d4b\u8bd5",id:"\u5728\u7ebf\u6d4b\u8bd5",level:3},{value:"\u7279\u5b9a\u73af\u5883\u8bf4\u660e",id:"\u7279\u5b9a\u73af\u5883\u8bf4\u660e",level:2},{value:"\u672c\u5730\u5f00\u53d1\u73af\u5883\u96c6\u7fa4",id:"\u672c\u5730\u5f00\u53d1\u73af\u5883\u96c6\u7fa4",level:3},{value:"minikube",id:"minikube",level:4},{value:"MicroK8s",id:"microk8s",level:4},{value:"Docker Desktop",id:"docker-desktop",level:4},{value:"\u4e91\u90e8\u7f72\u73af\u5883",id:"\u4e91\u90e8\u7f72\u73af\u5883",level:3},{value:"AWS",id:"aws",level:4},{value:"Network Load Balancer(NLB)",id:"network-load-balancernlb",level:5},{value:"TLS termination in AWS Load Balancer(NLB)",id:"tls-termination-in-aws-load-balancernlb",level:5},{value:"NLB Idle Timeouts",id:"nlb-idle-timeouts",level:5},{value:"GCE-GKE",id:"gce-gke",level:4},{value:"Azure",id:"azure",level:4},{value:"Digital Ocean",id:"digital-ocean",level:4},{value:"Scaleway",id:"scaleway",level:4},{value:"Exoscale",id:"exoscale",level:4},{value:"Oracle Cloud Infrastructure",id:"oracle-cloud-infrastructure",level:4},{value:"Bare Metal Clusters",id:"bare-metal-clusters",level:3},{value:"Miscellaneous",id:"miscellaneous",level:2},{value:"Checking ingress controller version",id:"checking-ingress-controller-version",level:3},{value:"Scope",id:"scope",level:3},{value:"Webhook network access",id:"webhook-network-access",level:3},{value:"Certificate generation",id:"certificate-generation",level:3},{value:"Running on k8s version older than 1.19",id:"running-on-k8s-version-older-than-119",level:3}];function t(e){const n={a:"a",blockquote:"blockquote",code:"code",h2:"h2",h3:"h3",h4:"h4",h5:"h5",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,l.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.p,{children:"\u652f\u6301\u591a\u79cd\u5b89\u88c5\u65b9\u5f0f\uff1a"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"\u4f7f\u7528Helm\uff0c\u4ecechart\u4ed3\u5e93\u5b89\u88c5"}),"\n",(0,r.jsxs)(n.li,{children:["\u4f7f\u7528",(0,r.jsx)(n.code,{children:"kubectl apply"}),"\uff0cYAML\u6e05\u5355\u5b89\u88c5"]}),"\n",(0,r.jsxs)(n.li,{children:["\u4ece\u7279\u6b8a\u52a0\u8f7d\u9879\u5b89\u88c5\uff08\u4f8b\u5982\uff1a",(0,r.jsx)(n.a,{href:"#minikube",children:"minikube"}),"\u6216\u8005",(0,r.jsx)(n.a,{href:"#microk8s",children:"MicroK8s"}),"\uff09"]}),"\n"]}),"\n",(0,r.jsxs)(n.p,{children:["\u5bf9\u4e8e\u5927\u591a\u6570",(0,r.jsx)(n.code,{children:"Kubernetes"}),"\u96c6\u7fa4\uff0cingress controller\u4e0d\u9700\u8981\u4efb\u4f55\u989d\u5916\u7684\u914d\u7f6e\u5373\u53ef\u5de5\u4f5c\u3002\u5982\u679c\u4f60\u60f3\u5c3d\u5feb\u5f00\u59cb\u4f7f\u7528\uff0c\u60a8\u53ef\u4ee5\u67e5\u770b",(0,r.jsx)(n.a,{href:"#%E5%BF%AB%E9%80%9F%E5%90%AF%E5%8A%A8",children:"\u5feb\u901f\u542f\u52a8"}),"\u8bf4\u660e\u3002\u4f46\u662f\uff0c\u5728\u8bb8\u591a\u73af\u5883\u4e2d\uff0c\u60a8\u53ef\u4ee5\u901a\u8fc7\u542f\u7528\u989d\u5916\u7684\u7279\u6027\u6765\u63d0\u9ad8\u6027\u80fd\u6216\u83b7\u5f97\u66f4\u597d\u7684\u65e5\u5fd7\u3002\u6211\u4eec\u63a8\u8350\u60a8\u67e5\u770b",(0,r.jsx)(n.a,{href:"#%E7%89%B9%E5%AE%9A%E7%8E%AF%E5%A2%83%E8%AF%B4%E6%98%8E",children:"\u7279\u5b9a\u73af\u5883\u8bf4\u660e"}),"\u6709\u5173\u4e3a\u7279\u5b9a\u73af\u5883\u6216\u4e91\u63d0\u4f9b\u5546\u4f18\u5316\u5165\u53e3\u63a7\u5236\u5668\u7684\u8be6\u7ec6\u4fe1\u606f\u3002"]}),"\n",(0,r.jsx)(n.h2,{id:"\u5185\u5bb9",children:"\u5185\u5bb9"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"\u5feb\u901f\u542f\u52a8"}),"\n",(0,r.jsxs)(n.li,{children:["\u7279\u5b9a\u73af\u5883\u8bf4\u660e","\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Docker desktop"}),"\n",(0,r.jsx)(n.li,{children:"minikube"}),"\n",(0,r.jsx)(n.li,{children:"MicroK8s"}),"\n",(0,r.jsx)(n.li,{children:"AWS"}),"\n",(0,r.jsx)(n.li,{children:"GCE - GKE"}),"\n",(0,r.jsx)(n.li,{children:"Azure"}),"\n",(0,r.jsx)(n.li,{children:"Digital Ocean"}),"\n",(0,r.jsx)(n.li,{children:"Scaleway"}),"\n",(0,r.jsx)(n.li,{children:"Exoscale"}),"\n",(0,r.jsx)(n.li,{children:"Oracle cloud infrastructure"}),"\n",(0,r.jsx)(n.li,{children:"Bare-metal(\u88f8\u91d1\u5c5e)"}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(n.li,{children:"\u6df7\u5408"}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"\u5feb\u901f\u542f\u52a8",children:"\u5feb\u901f\u542f\u52a8"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"\u5982\u679c\u60a8\u6709\u5b89\u88c5Helm"}),"\uff0c\u53ef\u4ee5\u4f7f\u7528\u4ee5\u4e0b\u547d\u4ee4\u5b89\u88c5",(0,r.jsx)(n.code,{children:"ingress controller"}),":"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"helm upgrade --install ingress-nginx ingress-nginx \\\r\n  --repo https://kubernetes.github.io/ingress-nginx \\\r\n  --namespace ingress-nginx --create-namespace\n"})}),"\n",(0,r.jsxs)(n.p,{children:["\u8fd9\u4e2a\u547d\u4ee4\u76f8\u5f53\u4e8e\uff1a\r\n\u5982\u679c\u5df2\u7ecf\u5b89\u88c5\u63a7\u5236\u5668\uff0c\u5c31\u66f4\u65b0\uff1b\u5982\u679c\u6ca1\u6709\u5b89\u88c5\u5219\u5b89\u88c5\u3002\r\n",(0,r.jsx)(n.strong,{children:"\u5982\u679c\u60a8\u6ca1\u6709\u5b89\u88c5Helm"}),"\uff0c\u6216\u8005\u60a8\u66f4\u559c\u6b22\u4f7f\u7528YAML\u6e05\u5355\uff0c\u60a8\u53ef\u4ee5\u8fd0\u884c\u4ee5\u4e0b\u547d\u4ee4\u5b89\u88c5\u63a7\u5236\u5668\uff1a"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"kubectl apply -f https://raw.githubusercontent.com/kubernetes/ingress-nginx/controller-v1.2.0/deploy/static/provider/cloud/deploy.yaml\n"})}),"\n",(0,r.jsxs)(n.blockquote,{children:["\n",(0,r.jsx)(n.p,{children:"\u4e0a\u9762\u547d\u4ee4\u4f7f\u7528\u7684YAML\u6e05\u5355\u662f\u7531Helm\u6a21\u677f\u751f\u6210\u7684\uff0c\u56e0\u6b64\u4e0a\u9762\u4e24\u79cd\u5b89\u88c5\u65b9\u5f0f\u5f97\u5230\u7684k8s\u8d44\u6e90\u662f\u76f8\u540c\u7684\u3002"}),"\n"]}),"\n",(0,r.jsxs)(n.blockquote,{children:["\n",(0,r.jsxs)(n.p,{children:["\u6ce8\u610f\uff1a\u5982\u679c\u60a8\u7684k8s\u7248\u672c\u6bd4\u8f83\u8001\uff081.18\u6216\u66f4\u65e9\uff09\uff0c\u8bf7\u9605\u8bfb",(0,r.jsx)(n.a,{href:"https://github.com/kubernetes/ingress-nginx/blob/main/docs/deploy/index.md#running-on-Kubernetes-versions-older-than-1.19",children:"\u8fd9\u6bb5"}),"\u7279\u6b8a\u8bf4\u660e\u3002"]}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"\u4f7f\u7528\u524d\u68c0\u67e5",children:"\u4f7f\u7528\u524d\u68c0\u67e5"}),"\n",(0,r.jsxs)(n.p,{children:["\u5728",(0,r.jsx)(n.code,{children:"nginx-ingress"}),"\u8fd9\u4e2a\u547d\u540d\u7a7a\u95f4\u4e0b\uff0c\u5e94\u8be5\u6709\u51e0\u4e2apods\u8fd0\u884c\u3002"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"kubectl get pods --namespace=ingress-nginx\n"})}),"\n",(0,r.jsx)(n.p,{children:"\u7a0d\u7b49\u4e00\u4f1a\uff0c\u8fd9\u51e0\u4e2apods\u5c06\u5904\u4e8e\u8fd0\u884c\u4e2d\u72b6\u6001\u3002\u4e0b\u9762\u7684\u547d\u4ee4\u5c06\u7b49\u5f85\u5165\u53e3\u63a7\u5236\u5668POD\u542f\u52a8\u3001\u8fd0\u884c\u5e76\u51c6\u5907\u5c31\u7eea\uff1a"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"kubectl wait --namespace ingress-nginx \\\r\n  --for=condition=ready pod \\  --selector=app.kubernetes.io/component=controller \\  --timeout=120s\n"})}),"\n",(0,r.jsx)(n.h3,{id:"\u672c\u5730\u6d4b\u8bd5",children:"\u672c\u5730\u6d4b\u8bd5"}),"\n",(0,r.jsx)(n.p,{children:"\u521b\u5efa\u4e00\u4e2a\u7b80\u5355\u7684\u7f51\u7edc\u670d\u52a1\uff0c\u4ee5\u53ca\u76f8\u5173\u8054\u7684service\uff0c"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"kubectl create deployment demo --image=httpd --port=80\r\nkubectl expose deployment demo\n"})}),"\n",(0,r.jsx)(n.p,{children:"\u7136\u540e\u521b\u5efa\u4e00\u4e2aingress\u8d44\u6e90"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"kubectl create ingress demo-localhost --class=nginx \\\r\n  --rule=demo.localdev.me/*=demo:80\n"})}),"\n",(0,r.jsx)(n.p,{children:"\u7136\u540e\uff0c\u6620\u5c04\u4e00\u4e2a\u672c\u5730\u7aef\u53e3"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"kubectl port-forward --namespace=ingress-nginx service/ingress-nginx-controller 8080:80\n"})}),"\n",(0,r.jsxs)(n.p,{children:["\u5230\u8fd9\u91cc\u4e4b\u540e\uff0c\u5982\u679c\u4f60\u5728\u6d4f\u89c8\u5668\u8bbf\u95ee",(0,r.jsx)(n.a,{href:"http://demo.localdev.me:8080/",children:"http://demo.localdev.me:8080/"}),"\uff0c\u4f60\u5c06\u770b\u5230\u4e00\u4e2a\u5199\u7740\u201cit works!\u201d\u7684html\u9875\u9762\u3002"]}),"\n",(0,r.jsx)(n.h3,{id:"\u5728\u7ebf\u6d4b\u8bd5",children:"\u5728\u7ebf\u6d4b\u8bd5"}),"\n",(0,r.jsxs)(n.p,{children:["\u5982\u679c\u60a8\u7684Kubernetes\u96c6\u7fa4\u662f\u4e00\u4e2a\u201c\u771f\u6b63\u7684\u201d\u96c6\u7fa4\uff0c\u5b83\u652f\u6301",(0,r.jsx)(n.code,{children:"LoadBalenger"}),"\u7c7b\u578b\u7684\u670d\u52a1\uff0c\u5b83\u5c06\u5411\u5165\u53e3\u63a7\u5236\u5668\u5206\u914d\u5916\u90e8IP\u5730\u5740\u6216FQDN\u3002\r\n\u60a8\u53ef\u4ee5\u901a\u8fc7\u4ee5\u4e0b\u547d\u4ee4\u770b\u5230IP\u5730\u5740\u6216FQDN\uff1a"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"kubectl get service ingress-nginx-controller --namespace=ingress-nginx\n"})}),"\n",(0,r.jsxs)(n.p,{children:["\u5b83\u5c06\u662f",(0,r.jsx)(n.code,{children:"EXTERNAL"}),"\u5b57\u6bb5\u3002\u5982\u679c\u8be5\u5b57\u6bb5\u663e\u793a",(0,r.jsx)(n.code,{children:"<Pending>"}),"\uff0c\u8fd9\u610f\u5473\u7740\u60a8\u7684Kubernetes\u96c6\u7fa4\u65e0\u6cd5\u63d0\u4f9b\u8d1f\u8f7d\u5747\u8861\u5668(\u901a\u5e38\uff0c\u8fd9\u662f\u56e0\u4e3a\u5b83\u4e0d\u652f\u6301",(0,r.jsx)(n.code,{children:"LoadBalenger"}),"\u7c7b\u578b\u7684\u670d\u52a1)\u3002\r\n\u5982\u679c\u6709\u5916\u90e8IP\u5730\u5740(\u6216\u8005FQDN)\uff0c\u8bbe\u7f6e\u4e00\u4e2a\u6307\u5411\u5b83\u7684DNS\u8bb0\u5f55\u3002\u7136\u540e\u521b\u5efa\u4e00\u4e2aingress\u8d44\u6e90\u3002\u4e0b\u9762\u8fd9\u4e2a\u793a\u4f8b\uff0c\u5047\u5b9a\u8bbe\u7f6e\u4e86\u4e00\u4e2a",(0,r.jsx)(n.code,{children:"www.demo.io"}),"\u7684DNS\uff1a"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:'kubectl create ingress demo --class=nginx \\\r\n  --rule="www.demo.io/*=demo:80"\n'})}),"\n",(0,r.jsxs)(n.p,{children:["\u6216\u8005\uff0c\u4e0a\u9762\u7684\u547d\u4ee4\u53ef\u4ee5\u4f7f\u7528",(0,r.jsx)(n.code,{children:"--rule"}),"\u547d\u4ee4\u66ff\u4ee3\uff1a"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"kubectl create ingress demo --class=nginx \\\r\n  --rule www.demo.io/=demo:80\n"})}),"\n",(0,r.jsxs)(n.p,{children:["\u5f53\u6d4f\u89c8\u5668\u8bbf\u95ee",(0,r.jsx)(n.a,{href:"http://www.demo.io/",children:"http://www.demo.io/"}),"\u65f6\uff0c\u4f60\u53ef\u4ee5\u770b\u5230\u4e00\u4e2a\u5199\u7740\u201cit works!\u201d\u7684html\u9875\u9762\u3002\u606d\u559c\u60a8\uff0c\u60a8\u6b63\u5728\u4e3a\u4e00\u4e2a\u5728Kubernetes\u96c6\u7fa4\u4e0a\u6258\u7ba1\u7684\u516c\u5171\u7f51\u7ad9\u670d\u52a1\uff01 \ud83c\udf89"]}),"\n",(0,r.jsx)(n.h2,{id:"\u7279\u5b9a\u73af\u5883\u8bf4\u660e",children:"\u7279\u5b9a\u73af\u5883\u8bf4\u660e"}),"\n",(0,r.jsx)(n.h3,{id:"\u672c\u5730\u5f00\u53d1\u73af\u5883\u96c6\u7fa4",children:"\u672c\u5730\u5f00\u53d1\u73af\u5883\u96c6\u7fa4"}),"\n",(0,r.jsx)(n.h4,{id:"minikube",children:"minikube"}),"\n",(0,r.jsx)(n.p,{children:"\u5165\u53e3\u63a7\u5236\u5668\u53ef\u4ee5\u901a\u8fc7Minkube\u7684\u52a0\u8f7d\u9879\u7cfb\u7edf\u5b89\u88c5\uff1a"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"minikube addons enable ingress\n"})}),"\n",(0,r.jsx)(n.h4,{id:"microk8s",children:"MicroK8s"}),"\n",(0,r.jsx)(n.p,{children:"\u5165\u53e3\u63a7\u5236\u5668\u53ef\u4ee5\u901a\u8fc7MicroK8s\u7684\u52a0\u8f7d\u9879\u7cfb\u7edf\u5b89\u88c5\uff1a"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"microk8s enable ingress\n"})}),"\n",(0,r.jsxs)(n.p,{children:["\u8be6\u60c5\u8bf7\u67e5\u770b",(0,r.jsx)(n.a,{href:"https://microk8s.io/docs/addon-ingress",children:"MicroK8s\u6587\u6863"})]}),"\n",(0,r.jsx)(n.h4,{id:"docker-desktop",children:"Docker Desktop"}),"\n",(0,r.jsx)(n.p,{children:"\u4ee5\u4e0bDocker Desktop\u7248\u672c\u652f\u6301Kubernetes\uff1a"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["Mac\uff1a",(0,r.jsx)(n.a,{href:"https://docs.docker.com/docker-for-mac/release-notes/#stable-releases-of-2018",children:"version 18.06.0-ce"})]}),"\n",(0,r.jsxs)(n.li,{children:["Windows\uff1a",(0,r.jsx)(n.a,{href:"https://docs.docker.com/docker-for-windows/release-notes/#docker-community-edition-18060-ce-win70-2018-07-25",children:"version 18.06.0-ce"})]}),"\n"]}),"\n",(0,r.jsxs)(n.p,{children:["\u9996\u5148\uff0c\u786e\u8ba4Docker\u8bbe\u7f6e\u4e2d\u662f\u5426\u542f\u7528Kubernetes\u3002\u547d\u4ee4",(0,r.jsx)(n.code,{children:"kubectl get nodes"}),"\u9700\u663e\u793a\u4e00\u4e2a\u540d\u4e3a",(0,r.jsx)(n.code,{children:"docker-desktop"}),"\u7684\u5355\u8282\u70b9\u3002\r\n\u5728docker desktop\u53ef\u4ee5\u4f7f\u7528\u9ed8\u8ba4\u5feb\u901f\u542f\u52a8\u8bf4\u660e\uff0c\u5b89\u88c5ingress\u63a7\u5236\u5668\u3002\r\n\u5728\u5927\u90e8\u5206\u7cfb\u7edf\u4e2d\uff0c\u5982\u679c\u6ca1\u6709\u5176\u4ed6",(0,r.jsx)(n.code,{children:"LoadBalancer"}),"\u7c7b\u578b\u7684service\u7ed1\u5b9a\u523080\u7aef\u53e3\uff0cingress\u63a7\u5236\u5668\u5c06\u88ab\u6307\u6d3e\u4e00\u4e2a",(0,r.jsx)(n.code,{children:"localhost"}),"\u7684\u5916\u90e8IP(",(0,r.jsx)(n.code,{children:"EXTERNAL_IP"}),")\uff0c\u8fd9\u610f\u5473\u7740\u5b83\u53ef\u4ee5\u5728\u672c\u5730\u901a\u8fc7",(0,r.jsx)(n.code,{children:"localhost:80"}),"\u8bbf\u95ee\u3002\u5982\u679c\u4e0d\u8d77\u4f5c\u7528\uff0c\u4f60\u53ef\u80fd\u9700\u8981\u56de\u5230",(0,r.jsx)(n.a,{href:"#%E6%9C%AC%E5%9C%B0%E6%B5%8B%E8%AF%95",children:"\u672c\u5730\u6d4b\u8bd5"}),"\u7ae0\u8282\u7684",(0,r.jsx)(n.code,{children:"kubectl port-forward"}),"\u65b9\u6cd5\u63cf\u8ff0\u3002"]}),"\n",(0,r.jsx)(n.h3,{id:"\u4e91\u90e8\u7f72\u73af\u5883",children:"\u4e91\u90e8\u7f72\u73af\u5883"}),"\n",(0,r.jsxs)(n.p,{children:["\u5728\u67d0\u4e9b\u60c5\u51b5\u4e0b\uff0c\u5982\u679c\u4e91\u63d0\u4f9b\u5546\u7684\u8d1f\u8f7d\u5e73\u8861\u5668\u5bf9\u5176\u540e\u7aef\u6267\u884c\u4e3b\u52a8\u5065\u5eb7\u68c0\u67e5(\u5927\u591a\u6570\u662f\u8fd9\u6837)\uff0c\u4f60\u53ef\u4ee5\u66f4\u6539ingress\u63a7\u5236\u5668service\u7684",(0,r.jsx)(n.code,{children:"externalTrafficPolicy"}),"\u4e3a",(0,r.jsx)(n.code,{children:"Local"}),"(\u9ed8\u8ba4\u503c\u4e3a",(0,r.jsx)(n.code,{children:"Cluster"}),")\u6765\u4fdd\u5b58\u4e00\u4e2a\u989d\u5916\u7684hop\u3002\u5982\u679c\u60a8\u4f7f\u7528Helm\u5b89\u88c5\uff0c\u53ef\u4ee5\u5728",(0,r.jsx)(n.code,{children:"helm install"}),"\u6216\u8005",(0,r.jsx)(n.code,{children:"helm upgrade"}),"\u65f6\u6dfb\u52a0\u547d\u4ee4",(0,r.jsx)(n.code,{children:"--set controller.service.externalTrafficPolicy=Local"}),"\u6765\u5b8c\u6210\u4e0a\u8ff0\u64cd\u4f5c\u3002"]}),"\n",(0,r.jsxs)(n.p,{children:["\u6b64\u5916\uff0c\u5982\u679c\u4e91\u670d\u52a1\u63d0\u4f9b\u5546\u7684\u8d1f\u8f7d\u5747\u8861\u5668\uff0c\u652f\u6301\u4ee3\u7406\u534f\u8bae\uff0c\u4f60\u53ef\u4ee5\u542f\u7528\u5b83\uff0c\u5b83\u53ef\u4ee5\u8ba9ingress\u63a7\u5236\u5668\u770b\u5230\u5ba2\u6237\u7aef\u7684\u771f\u5b9eIP\u5730\u5740\u3002\u5426\u5219\uff0c\u901a\u5e38\u4f1a\u770b\u5230\u4e0a\u884c\u8d1f\u8f7d\u5747\u8861\u5668\u7684IP\u5730\u5740\u3002\u8981\u5b9e\u73b0\u8fd9\u4e2a\u6548\u679c\uff0c\u5fc5\u987b\u540c\u65f6\u5728\u4e91\u63d0\u4f9b\u5546\u7684\u8d1f\u8f7d\u5747\u8861\u5668\u914d\u7f6e\uff0c\u4ee5\u53caingress\u63a7\u5236\u5668\u8bbe\u7f6e",(0,r.jsx)(n.code,{children:"--set controller.config.use-proxy-protocol=true"}),"\u624d\u80fd\u751f\u6548\u3002"]}),"\n",(0,r.jsx)(n.p,{children:"\u5728\u4e0b\u9762\u7684\u90e8\u5206\u4e2d\uff0c\u6211\u4eec\u63d0\u4f9b\u4e86YAML\u6e05\u5355\uff0c\u5728\u53ef\u80fd\u7684\u60c5\u51b5\u4e0b\u4f7f\u7528\u5404\u79cd\u4e91\u63d0\u4f9b\u5546\u7684\u7279\u5b9a\u9009\u9879\u542f\u7528\u8fd9\u4e9b\u9009\u9879\u3002"}),"\n",(0,r.jsx)(n.h4,{id:"aws",children:"AWS"}),"\n",(0,r.jsxs)(n.p,{children:["\u5728AWS\u4e2d\uff0c\u6211\u4eec\u4f7f\u7528\u4e00\u4e2a\u7f51\u7edc\u8d1f\u8f7d\u5747\u8861\u5668",(0,r.jsx)(n.code,{children:"Network Load Balancer(NLB)"}),"\u66b4\u9732Service\u7684type\u7c7b\u578b\u4e3a",(0,r.jsx)(n.code,{children:"LoadBalancer"}),"\u7684",(0,r.jsx)(n.code,{children:"nginx ingress controller"}),"\u3002"]}),"\n",(0,r.jsxs)(n.blockquote,{children:["\n",(0,r.jsx)(n.p,{children:"info"}),"\n"]}),"\n",(0,r.jsx)(n.h5,{id:"network-load-balancernlb",children:"Network Load Balancer(NLB)"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"kubectl apply -f https://raw.githubusercontent.com/kubernetes/ingress-nginx/controller-v1.2.0/deploy/static/provider/aws/deploy.yaml\n"})}),"\n",(0,r.jsx)(n.h5,{id:"tls-termination-in-aws-load-balancernlb",children:"TLS termination in AWS Load Balancer(NLB)"}),"\n",(0,r.jsx)(n.p,{children:"\u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0cTLS\u5728\u5165\u53e3\u63a7\u5236\u5668\u4e2d\u7ec8\u6b62\u3002\u4f46\u5728\u8d1f\u8f7d\u5747\u8861\u5668\u4e2d\u4e5f\u6709\u53ef\u80fd\u7ec8\u6b62TLS\u3002\u672c\u8282\u89e3\u91ca\u5982\u4f55\u4f7f\u7528NLB\u5728AWS\u4e0a\u6267\u884c\u6b64\u64cd\u4f5c\u3002"}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsx)(n.li,{children:"\u4e0b\u8f7ddeploy.yaml\u6a21\u677f"}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"wget https://raw.githubusercontent.com/kubernetes/ingress-nginx/controller-v1.2.0/deploy/static/provider/aws/nlb-with-tls-termination/deploy.yaml\n"})}),"\n",(0,r.jsxs)(n.ol,{start:"2",children:["\n",(0,r.jsx)(n.li,{children:"\u4fee\u6539\u6587\u4ef6\uff0c\u5c06PVC CIDR\u6539\u4e3a\u5bf9\u5e94\u7684k8s\u96c6\u7fa4\u914d\u7f6e"}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"proxy-real-ip-cidr: XXX.XXX.XXX/XX\n"})}),"\n",(0,r.jsxs)(n.ol,{start:"3",children:["\n",(0,r.jsx)(n.li,{children:"\u8fd8\u66f4\u6539AWS\u8bc1\u4e66\u7ba1\u7406\u5668(ACM)ID\uff1a"}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"arn:aws:acm:us-west-2:XXXXXXXX:certificate/XXXXXX-XXXXXXX-XXXXXXX-XXXXXXXX\n"})}),"\n",(0,r.jsxs)(n.ol,{start:"4",children:["\n",(0,r.jsx)(n.li,{children:"\u90e8\u7f72yaml\u6e05\u5355"}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"kubectl apply -f deploy.yaml\n"})}),"\n",(0,r.jsx)(n.h5,{id:"nlb-idle-timeouts",children:"NLB Idle Timeouts"}),"\n",(0,r.jsxs)(n.p,{children:["TCP\u8bf7\u6c42\u7684\u7a7a\u95f2\u8d85\u65f6\u65f6\u95f4\u4e3a350\u79d2\uff0c\u5e76\u4e14\u65e0\u6cd5\u4fee\u6539\u3002\r\n\u7531\u4e8e\u8fd9\u4e2a\u539f\u56e0\uff0c\u60a8\u9700\u8981\u786e\u4fdd",(0,r.jsx)(n.code,{children:"keepalive_timeout"}),"\u503c\u7684\u914d\u7f6e\u5c0f\u4e8e350\u79d2\u624d\u80fd\u6309\u9884\u671f\u5de5\u4f5c\u3002\r\nnginx\u7684\u9ed8\u8ba4",(0,r.jsx)(n.code,{children:"keepalive_timeout"}),"\u503c\u4e3a",(0,r.jsx)(n.code,{children:"75s"}),"\u3002\r\n\u5173\u4e8e\u8d85\u65f6\u7684\u66f4\u591a\u8be6\u7ec6\u4fe1\u606f\uff0c\u8bf7\u67e5\u770b",(0,r.jsx)(n.a,{href:"https://docs.aws.amazon.com/elasticloadbalancing/latest/network/network-load-balancers.html#connection-idle-timeout",children:"AWS\u5b98\u65b9\u6587\u6863"})]}),"\n",(0,r.jsx)(n.h4,{id:"gce-gke",children:"GCE-GKE"}),"\n",(0,r.jsxs)(n.p,{children:["\u9996\u5148\uff0c\u4f60\u7684\u7528\u6237\u9700\u8981\u5728k8s\u96c6\u7fa4\u4e2d\u62e5\u6709",(0,r.jsx)(n.code,{children:"cluster-admin"}),"\u6743\u9650\u3002\u53ef\u4ee5\u4f7f\u7528\u4ee5\u4e0b\u547d\u4ee4\u83b7\u53d6\u6743\u9650\uff1a"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"kubectl create clusterrolebinding cluster-admin-binding \\\r\n  --clusterrole cluster-admin \\  --user $(gcloud config get-value account)\n"})}),"\n",(0,r.jsx)(n.p,{children:"\u7136\u540e\uff0c\u4f60\u53ef\u4ee5\u5982\u4e0b\u65b9\u5f0f\uff0c\u5b89\u88c5ingress\u63a7\u5236\u5668\uff1a"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"kubectl apply -f https://raw.githubusercontent.com/kubernetes/ingress-nginx/controller-v1.2.0/deploy/static/provider/cloud/deploy.yaml\n"})}),"\n",(0,r.jsxs)(n.blockquote,{children:["\n",(0,r.jsxs)(n.p,{children:["warnning \u5bf9\u4e8e\u79c1\u6709\u96c6\u7fa4\uff0c\u60a8\u8fd8\u9700\u8981\u6dfb\u52a0\u4e00\u6761\u989d\u5916\u7684\u9632\u706b\u5899\u89c4\u5219\uff0c\u6765\u5141\u8bb8\u96c6\u7fa4master\u8282\u70b9\u5728\u5de5\u4f5c\u8282\u70b9\u4e0a\u914d\u7f6e\u4f7f\u7528",(0,r.jsx)(n.code,{children:"8443/tcp"}),"\u7aef\u53e3\uff0c\u6216\u8005\u4fee\u6539\u5141\u8bb8\u8bbf\u95ee\u7aef\u53e3",(0,r.jsx)(n.code,{children:"80/tcp"}),"\u3001",(0,r.jsx)(n.code,{children:"443/tcp"}),"\u548c",(0,r.jsx)(n.code,{children:"10254/tcp"}),"\u7684\u73b0\u6709\u89c4\u5219\uff0c\u4e5f\u5141\u8bb8\u8bbf\u95ee\u7aef\u53e3",(0,r.jsx)(n.code,{children:"8443/tcp"}),"\u3002"]}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"See the [GKE documentation](https://cloud.google.com/kubernetes-engine/docs/how-to/private-clusters#add_firewall_rules) on adding rules and the [Kubernetes issue](https://github.com/kubernetes/kubernetes/issues/79739) for more detail.\n"})}),"\n",(0,r.jsxs)(n.blockquote,{children:["\n",(0,r.jsxs)(n.p,{children:["\u6ce8\u610f\uff0c",(0,r.jsx)(n.code,{children:"KCE-GKE"}),"\u4e0d\u652f\u6301\u4ee3\u7406\u534f\u8bae\uff01"]}),"\n"]}),"\n",(0,r.jsx)(n.h4,{id:"azure",children:"Azure"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"kubectl apply -f https://raw.githubusercontent.com/kubernetes/ingress-nginx/controller-v1.2.0/deploy/static/provider/cloud/deploy.yaml\n"})}),"\n",(0,r.jsxs)(n.p,{children:["\u5173\u4e8eAzure\u6ce8\u89e3\u7684\u66f4\u591a\u4fe1\u606f\uff0c\u8bf7\u67e5\u770b",(0,r.jsx)(n.a,{href:"https://docs.microsoft.com/en-us/azure/aks/ingress-internal-ip#create-an-ingress-controller",children:"AKS\u5b98\u65b9\u6587\u6863"})]}),"\n",(0,r.jsx)(n.h4,{id:"digital-ocean",children:"Digital Ocean"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"kubectl apply -f https://raw.githubusercontent.com/kubernetes/ingress-nginx/controller-v1.2.0/deploy/static/provider/do/deploy.yaml\n"})}),"\n",(0,r.jsx)(n.h4,{id:"scaleway",children:"Scaleway"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"kubectl apply -f https://raw.githubusercontent.com/kubernetes/ingress-nginx/controller-v1.2.0/deploy/static/provider/scw/deploy.yaml\n"})}),"\n",(0,r.jsx)(n.h4,{id:"exoscale",children:"Exoscale"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"kubectl apply -f https://raw.githubusercontent.com/kubernetes/ingress-nginx/main/deploy/static/provider/exoscale/deploy.yaml\n"})}),"\n",(0,r.jsxs)(n.p,{children:["Exoscale\u652f\u6301\u7684\u6ce8\u91ca\u7684\u5b8c\u6574\u5217\u8868\u53ef\u5728ExoscaleCloudController Manager",(0,r.jsx)(n.a,{href:"https://github.com/exoscale/exoscale-cloud-controller-manager/blob/master/docs/service-loadbalancer.md",children:"\u6587\u6863"}),"\u4e2d\u83b7\u5f97\u3002"]}),"\n",(0,r.jsx)(n.h4,{id:"oracle-cloud-infrastructure",children:"Oracle Cloud Infrastructure"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"kubectl apply -f https://raw.githubusercontent.com/kubernetes/ingress-nginx/controller-v1.2.0/deploy/static/provider/cloud/deploy.yaml\n"})}),"\n",(0,r.jsxs)(n.p,{children:["Oracle\u4e91\u57fa\u7840\u8bbe\u65bd\u53ef\u7528\u6ce8\u91ca\u7684",(0,r.jsx)(n.a,{href:"https://github.com/oracle/oci-cloud-controller-manager/blob/master/docs/load-balancer-annotations.md",children:"\u5b8c\u6574\u5217\u8868"}),"\u53ef\u4ee5\u5728OCI Cloud Controller Manager",(0,r.jsx)(n.a,{href:"https://github.com/oracle/oci-cloud-controller-manager",children:"\u6587\u6863"}),"\u4e2d\u627e\u5230\u3002"]}),"\n",(0,r.jsx)(n.h3,{id:"bare-metal-clusters",children:"Bare Metal Clusters"}),"\n",(0,r.jsx)(n.p,{children:"\u672c\u8282\u9002\u7528\u4e8e\u90e8\u7f72\u5728\u88f8\u673a\u670d\u52a1\u5668\u4e0a\u7684Kubernetes\u7fa4\u96c6\uff0c\u4ee5\u53ca\u624b\u52a8\u5728\u201craw\u201d\u865a\u62df\u673a\u4e0a\u5b89\u88c5\u7684K8s\u96c6\u7fa4\uff0c\u4f7f\u7528\u901a\u7528Linux\u53d1\u884c\u7248\uff08\u4f8b\u5982CentOS, Ubuntu...\uff09"}),"\n",(0,r.jsxs)(n.p,{children:["\u4e3a\u4e86\u5feb\u901f\u6d4b\u8bd5\uff0c\u60a8\u53ef\u4ee5\u4f7f\u7528",(0,r.jsx)(n.code,{children:"NodePort"}),"\u3002\u8fd9\u5e94\u8be5\u9002\u7528\u4e8e\u51e0\u4e4e\u6240\u6709\u96c6\u7fa4\uff0c\u4f46\u5b83\u901a\u5e38\u4f1a\u4f7f\u7528\u8303\u56f4\u4e3a",(0,r.jsx)(n.code,{children:"30000-32767"}),"\u7684\u7aef\u53e3\u3002"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"kubectl apply -f https://raw.githubusercontent.com/kubernetes/ingress-nginx/controller-v1.2.0/deploy/static/provider/baremetal/deploy.yaml\n"})}),"\n",(0,r.jsxs)(n.p,{children:["\u5173\u4e8e\u5728\u88f8\u91d1\u5c5e\u90e8\u7f72\u7684\u66f4\u591a\u4fe1\u606f\uff0c\u8bf7\u67e5\u770b",(0,r.jsx)(n.a,{href:"https://github.com/kubernetes/ingress-nginx/blob/main/docs/deploy/baremetal.md",children:"\u88f8\u91d1\u5c5e\u6ce8\u610f\u4e8b\u9879"}),"\u3002"]}),"\n",(0,r.jsx)(n.h2,{id:"miscellaneous",children:"Miscellaneous"}),"\n",(0,r.jsx)(n.h3,{id:"checking-ingress-controller-version",children:"Checking ingress controller version"}),"\n",(0,r.jsxs)(n.p,{children:["\u4f7f\u7528",(0,r.jsx)(n.code,{children:"kubectl exec"}),"\u5728pod\u5bb9\u5668\u4e2d\u6267\u884c\u547d\u4ee4",(0,r.jsx)(n.code,{children:"/nginx-ingress-controller --version"})]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"POD_NAMESPACE=ingress-nginx\r\nPOD_NAME=$(kubectl get pods -n $POD_NAMESPACE -l app.kubernetes.io/name=ingress-nginx --field-selector=status.phase=Running -o name)\r\nkubectl exec $POD_NAME -n $POD_NAMESPACE -- /nginx-ingress-controller --version\n"})}),"\n",(0,r.jsx)(n.h3,{id:"scope",children:"Scope"}),"\n",(0,r.jsxs)(n.p,{children:["\u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0c\u63a7\u5236\u5668\u5728\u6240\u6709\u547d\u540d\u7a7a\u95f4\u76d1\u63a7",(0,r.jsx)(n.code,{children:"Ingress"}),"\u5bf9\u8c61\u3002\u5982\u679c\u4f60\u60f3\u6539\u53d8\u8fd9\u4e00\u884c\u4e3a\uff0c\u53ef\u4ee5\u4f7f\u7528",(0,r.jsx)(n.code,{children:"--watch-namespace"}),"\u6216\u8005\u68c0\u67e5Helm chart\u4e2d\u7684",(0,r.jsx)(n.code,{children:"controller.scope"}),"\u503c\uff0c\u6765\u9650\u5b9a\u63a7\u5236\u5668\u76d1\u542c\u67d0\u4e00\u4e2a\u5355\u72ec\u7684\u547d\u540d\u7a7a\u95f4\u3002"]}),"\n",(0,r.jsxs)(n.p,{children:["\u66f4\u591a\u8be6\u60c5\u8bf7\u67e5\u770b",(0,r.jsxs)(n.a,{href:"https://kubernetes.github.io/ingress-nginx/#how-to-easily-install-multiple-instances-of-the-ingress-nginx-controller-in-the-same-cluster",children:["\u5728\u540c\u4e00\u4e2a\u96c6\u7fa4\u5982\u4f55\u8f7b\u677e\u5b89\u88c5\u591a\u4e2a",(0,r.jsx)(n.code,{children:"ingress-nginx-controller"}),"\u5b9e\u4f8b"]}),"\u3002"]}),"\n",(0,r.jsx)(n.h3,{id:"webhook-network-access",children:"Webhook network access"}),"\n",(0,r.jsxs)(n.blockquote,{children:["\n",(0,r.jsxs)(n.p,{children:["\u8b66\u544a\uff1a\u63a7\u5236\u5668\u4f7f\u7528",(0,r.jsx)(n.a,{href:"https://kubernetes.io/docs/reference/access-authn-authz/extensible-admission-controllers/",children:"admission webhook"}),"\u6765\u6821\u9a8cIngress\u5b9a\u4e49\u3002\u786e\u4fdd\u6ca1\u6709\u7f51\u7edc\u7b56\u7565\u6216\u5176\u4ed6\u9632\u706b\u5899\u963b\u6b62\u4eceAPI\u670d\u52a1\u5668\u5230",(0,r.jsx)(n.code,{children:"ingress-nginx-controller-admission"}),"\u670d\u52a1\u7684\u8fde\u63a5\u3002"]}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"certificate-generation",children:"Certificate generation"}),"\n",(0,r.jsx)(n.p,{children:"\u751f\u6210\u8bc1\u4e66\u3002"}),"\n",(0,r.jsxs)(n.blockquote,{children:["\n",(0,r.jsxs)(n.p,{children:["\u6ce8\u610f\uff1aingress\u63a7\u5236\u5668\u542f\u52a8\u7684\u7b2c\u4e00\u65f6\u95f4\uff0c\u4e24\u4e2a",(0,r.jsx)(n.code,{children:"Job"}),"\u4f7f\u7528",(0,r.jsx)(n.code,{children:"admission webhook"}),"\u521b\u5efa",(0,r.jsx)(n.code,{children:"SSL"}),"\u8bc1\u4e66\u3002"]}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:"\u5728\u521b\u5efa\u548c\u9a8c\u8bc1Ingress\u5b9a\u4e49\u4e4b\u524d\uff0c\u8fd9\u53ef\u80fd\u4f1a\u5bfc\u81f4\u957f\u8fbe\u4e24\u5206\u949f\u7684\u521d\u59cb\u5ef6\u8fdf\u3002"}),"\n",(0,r.jsx)(n.p,{children:"\u60a8\u53ef\u4ee5\u8fd0\u884c\u4ee5\u4e0b\u547d\u4ee4\uff0c\u7b49\u5230\u5b83\u51c6\u5907\u597d\uff1a"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:" kubectl wait --namespace ingress-nginx \\\r\n  --for=condition=ready pod \\\r\n  --selector=app.kubernetes.io/component=controller \\\r\n  --timeout=120s\n"})}),"\n",(0,r.jsx)(n.h3,{id:"running-on-k8s-version-older-than-119",children:"Running on k8s version older than 1.19"}),"\n",(0,r.jsxs)(n.p,{children:["Ingress\u8d44\u6e90\u968f\u7740\u65f6\u95f4\u7684\u63a8\u79fb\u5728\u4e0d\u65ad\u8fdb\u5316\u3002\u4ece\u5f00\u59cb\u7684",(0,r.jsx)(n.code,{children:"apiVersion: extensions/v1beta1"}),"\uff0c\u5230",(0,r.jsx)(n.code,{children:"apiVersion: networking.k8s.io/v1beta1"}),"\uff0c\u518d\u5230\u4e0d\u4e45\u524d\u7684",(0,r.jsx)(n.code,{children:"apiVersion: networking.k8s.io/v1"}),"\u3002"]}),"\n",(0,r.jsx)(n.p,{children:"Kubernetes\u652f\u6301\u7684Ingress\u7248\u672c\u4fe1\u606f\u5982\u4e0b\uff1a"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"1.19\u7248\u672c\u4e4b\u524d\uff0c\u53ea\u652f\u6301``v1beta1`\u7248\u672c"}),"\n",(0,r.jsxs)(n.li,{children:["1.19\u52301.21\u7248\u672c\uff0c\u652f\u6301",(0,r.jsx)(n.code,{children:"v1beta1"}),"\u548c",(0,r.jsx)(n.code,{children:"v1"}),"\u7248\u672c"]}),"\n",(0,r.jsxs)(n.li,{children:["1.22\u7248\u672c\u4e4b\u540e\uff0c\u53ea\u652f\u6301",(0,r.jsx)(n.code,{children:"v1"}),"\u7248\u672c"]}),"\n"]}),"\n",(0,r.jsxs)(n.p,{children:["\u5728",(0,r.jsx)(n.code,{children:"nginx ingress controller"}),"\u4e2d\u5bf9ingress\u7248\u672c\u7684\u652f\u6301\uff1a"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["1.0\u7248\u672c\u4e4b\u524d\uff0c\u53ea\u652f\u6301",(0,r.jsx)(n.code,{children:"v1beta1"}),"\u7684ingress\u8d44\u6e90"]}),"\n",(0,r.jsxs)(n.li,{children:["1.0\u7248\u672c\u4e4b\u540e\uff0c\u53ea\u652f\u6301",(0,r.jsx)(n.code,{children:"v1"}),"\u7684ingress\u8d44\u6e90"]}),"\n"]}),"\n",(0,r.jsxs)(n.p,{children:["\u56e0\u6b64\uff0c\u5982\u679c\u4f60\u7684k8s\u7248\u672c\u4e3a1.19\u6216\u66f4\u65b0\u7248\u672c\uff0c\u4f60\u5e94\u8be5\u80fd\u591f\u4f7f\u7528\u6700\u65b0\u7248\u672c\u7684",(0,r.jsx)(n.code,{children:"nginx-ingress-controller"}),"\uff1b\u4f46\u662f\u5982\u679c\u4f60\u4f7f\u75281.19\u7248\u672c\u4e4b\u524d\u7684k8s\uff0c\u5fc5\u987b\u4f7f\u7528",(0,r.jsx)(n.code,{children:"0.X"}),"\u7248\u672c\u7684",(0,r.jsx)(n.code,{children:"nginx-ingress-controller"}),"\uff08\u4f8b\u5982\uff1a0.49\u7248\u672c\uff09\u3002"]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.code,{children:"nginx-ingress-controller"}),"\u7684Heml chart\u5728\u7248\u672c4\u4e2d\u5207\u6362\u5230\u7248\u672c1\u3002\u4e5f\u5c31\u662f\u8bf4\uff0c\u5982\u679c\u4f60\u7684k8s\u96c6\u7fa4\u7248\u672c\u4e3a1.19\u6216\u66f4\u65e9\uff0c\u4f60\u53ef\u4ee5\u4f7f\u7528",(0,r.jsx)(n.code,{children:"3.X"}),"\u7248\u672c\u7684chart\uff08\u53ef\u4ee5\u5728",(0,r.jsx)(n.code,{children:"heml install"}),"\u4e2d\u4f7f\u7528",(0,r.jsx)(n.code,{children:"--version='<4'"}),"\u547d\u4ee4\uff09\u3002"]})]})}function h(e={}){const{wrapper:n}={...(0,l.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(t,{...e})}):t(e)}},8453:(e,n,s)=>{s.d(n,{R:()=>i,x:()=>o});var r=s(6540);const l={},c=r.createContext(l);function i(e){const n=r.useContext(c);return r.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function o(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(l):e.components||l:i(e.components),r.createElement(c.Provider,{value:n},e.children)}}}]);